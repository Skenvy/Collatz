name: Echo ğŸ±â€ğŸ’» GitHub ğŸ±â€ğŸ‘¤ Context ğŸ“‘
on:
  push:
  # If you need to use this to test a payload for some event/condition.
  # Then change this from workflow_dispatch to whatever you need.
  workflow_dispatch:
  # Made callable to be used by any build that wants it's context
  workflow_call:
permissions:
  contents: write
defaults:
  run:
    shell: bash
jobs:
  echo-payload:
    name: Echo ğŸ±â€ğŸ’» GitHub ğŸ±â€ğŸ‘¤ Context ğŸ“‘
    runs-on: ubuntu-latest
    steps:
    - name: Echo ğŸ±â€ğŸ’» GitHub ğŸ±â€ğŸ‘¤ Context ğŸ“‘
      env:
        GITHUB_CONTEXT: ${{ toJson(github) }}
      run: echo "$GITHUB_CONTEXT"
  merge:
    name: GitHub ğŸ±â€ğŸ‘¤ Pages ğŸ“„ Merger ğŸ§¬
    runs-on: ubuntu-latest
    steps:
    - name: ğŸ Checkout
      uses: actions/checkout@v3
    - name: Merge ğŸ§¬gh-pages-juliağŸ§¬ into ğŸ±â€ğŸ‘¤ gh-pages ğŸ“„
      run: |
        git config --local user.email "actions@github.com"
        git config --local user.name "Github Actions"
        git fetch --unshallow
        export FROM_SHA=$(git rev-parse --short=8 origin/gh-pages-julia)
        export TO_SHA=$(git rev-parse --short=8 origin/gh-pages)
        git checkout gh-pages && git pull
        git merge --squash origin/gh-pages-julia --allow-unrelated-histories -X theirs
        git commit -m "Auto-merge gh-pages-julia@($FROM_SHA) to gh-pages@($TO_SHA)" --allow-empty
        git push
