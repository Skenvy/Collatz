# Devlog
"JavaScript" is a hard target to pin down precisely what would be the best way to learn it, without first learning the history of the language, as an evolution of ECMA Script; see [ECMAScript Language Specification](https://tc39.es/ecma262/) and [ECMAScript Internationalization API Specification](https://tc39.es/ecma402/) for the _most_ "source of truth" as it gets for JavaScript (even if a cumbersome point of reference to get up and running with a project quickly, they are important to be aware of). As from the start the JavaScript ecosystem was fragmented across various browsers, there is no single source of truth for how a "JavaScript Engine" enacts the ECMAScript language spec, so it's worth knowing of the major engines (with there being a distinction between the [JavaScript Engine](https://en.wikipedia.org/wiki/JavaScript_engine) and the [Browser Engine](https://en.wikipedia.org/wiki/Browser_engine)).
* [ChakraCore](https://github.com/chakra-core/ChakraCore) is an evolution of the Microsoft IE JS Engine, Chakra.
* [JavaScriptCore](https://github.com/WebKit/webkit/blob/main/Source/JavaScriptCore/API/JavaScriptCore.h) (a part of [WebKit](https://webkit.org/)) ([opensource.apple](https://opensource.apple.com/projects/webkit/)) (or on [github](https://github.com/WebKit/WebKit))
    * [Bun](https://bun.sh/) (or on [github](https://github.com/oven-sh/bun)), a new and still experimental runtime which "embeds" JavaScriptCore.
* [SpiderMonkey](https://spidermonkey.dev/) ([firefox-source-docs](https://firefox-source-docs.mozilla.org/js/index.html)) ([mozilla-central/source](https://searchfox.org/mozilla-central/source/js/src)) ([Gecko on github](https://github.com/mozilla/gecko-dev))
* [V8](https://github.com/v8/v8) ([googlesource](https://chromium.googlesource.com/v8/v8.git)) [v8.dev](https://v8.dev/)
    * [Node.JS](https://nodejs.org/), or on [github](https://github.com/nodejs/node), is the most widely used JS Engine, and is built on V8.
    * [Deno](https://deno.land/), or on [github](https://github.com/denoland/deno), is also built on V8, with many more features OotB.

The three "server side runtimes" are Node (V8), Deno (V8), or the recent and experimental Bun (JavaScriptCore). Bun's package management is "npm compatible", so if our goal is to create a JavaScript package, we need to focus on Node and Deno.
* Node packages can be hosted on [npm](https://www.npmjs.com/) (see [Getting started](https://docs.npmjs.com/getting-started)), and are manually `npm publish`'d.
* Deno packages can be seen on [Deno Third Party Modules](https://deno.land/x) (see [Adding a module](https://deno.land/add_module)), and are cached from public GitHub repos.
* We also want to target the [github hosted npm registry](https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-npm-registry) (also see [Publishing Node.js packages](https://docs.github.com/en/actions/publishing-packages/publishing-nodejs-packages)).

At the time of writing this, `npm` already has a [`collatz` package](https://www.npmjs.com/package/collatz) (from [this repo](https://github.com/partkyle/collatz)), and `deno.land/x` has [collatz_wasm](https://deno.land/x/collatz_wasm@0.0.1) (which is [also on npm](https://www.npmjs.com/package/collatz-wasm)) (from [this repo](https://github.com/hexagon6/collatz-wasm)). For github hosted packages, we'll look at [this search](https://github.com/search?q=collatz&type=registrypackages). Oddly enough, at the time of writing this, I was getting ready to say there is no `npm` package with the name `collatz` in the github `npm` registry, as it was not appearing without being logged in, but when I searched again from a browser I was logged in with, [this package](https://github.com/pavan142/collatz/pkgs/npm/collatz) appeared.

A good resource for starting to learn "JavaScript" would be [mozilla's developer docs on JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript) ([or guide](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide)). Two links recommended by the GitHub "[Working with the npm registry](https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-npm-registry)" page include [Creating a package.json file](https://docs.npmjs.com/creating-a-package-json-file) and [Creating Node.js modules](https://docs.npmjs.com/creating-node-js-modules).

---

We'll need to start with [signing up to npm](https://www.npmjs.com/signup). I made [my profile](https://www.npmjs.com/~skenvy). Something that immediately stands out is that the one time password email includes links for [Configuring two-factor authentication](https://docs.npmjs.com/configuring-two-factor-authentication) and [Creating and viewing access tokens](https://docs.npmjs.com/creating-and-viewing-access-tokens), as `2FA` is required for logging in; although an "Automation" token can be made for publishing packages without a 2FA token, it can only be made from the website, not from the CLI. So we'll do that now. There's also an option to "Linked Accounts & Recovery Option" with a GitHub account, which seems worthwhile trying, if it didn't request the egregious permission of "Act on your behalf". Why does it want that permission?

An important concept for npm is [scope](https://docs.npmjs.com/about-scopes), both [public](https://docs.npmjs.com/about-public-packages) and [private](https://docs.npmjs.com/about-private-packages). I hadn't realised before that npm included this feature. But because the it is included we can focus on [creating a public **scoped** package](https://docs.npmjs.com/creating-and-publishing-scoped-public-packages), because there already exists an **unscoped** [collatz](https://www.npmjs.com/package/collatz) package on npm. Starting off, our `node --version` is `v17.6.0`, and our `npm -v` is `8.5.5`. We can create the initial [`package.json` file](https://docs.npmjs.com/cli/v8/configuring-npm/package-json) with default values (`--yes`) within a scope (`--scope=@scope-name`) by running `npm init --scope=@skenvy --yes`. Because it'll be initialised with a scope, we'll have to publish it with `npm publish --access=public`, as scoped packages default to private.

The [package license](https://docs.npmjs.com/cli/v8/configuring-npm/package-json#license) should be an [OSI approved](https://opensource.org/licenses/alphabetical) identifier from the [SPDX License List](https://spdx.org/licenses/). Although I'm trying to add as many of the optional data fields in the package json as possible, rather than use [`"files": ["*"],`](https://docs.npmjs.com/cli/v8/configuring-npm/package-json#files) we'll use an [.npmignore](https://docs.npmjs.com/cli/v8/using-npm/developers#testing-whether-your-npmignore-or-files-config-works) file, which can be tested with `npm pack` to generate the tarball locally. Although, to "use" the `.npmignore`, we don't actually need to add one, unless its contents would differ from the `.gitignore` that's already present, as outlined via "If there is a `.gitignore` file, and `.npmignore` is missing, `.gitignore`'s contents will be used instead." As a moment of learning, this being the first time I'm setting up a node package, I find it noteworthy that there is a ["browser" option](https://docs.npmjs.com/cli/v8/configuring-npm/package-json#browser), which is mutually exclusive with ["main"](https://docs.npmjs.com/cli/v8/configuring-npm/package-json#main) as I'd assumed node modules weren't supposed to target the client side! Other note worthy options are `bin` and `man` for packaging scripts that should be symlinked to a bin folder, and for requesting the man docs. Following this we have [a whole guide dedicated to the "scripts" dictionary entry](https://docs.npmjs.com/cli/v8/using-npm/scripts). Following the scripts and config, are several different ways to define dependencies (including `"overrides"` to lock sub-dependencies), there are the `"engines"`, `"os"`, and `"cpu"` options (and the `"private"` and `"publishConfig"` to prevent accidentally pushing/publishing).
